<div class="container mt-4">
  <h1><%= @post.title %></h1>

  <p>
    <% if @post.published %>
      <span class="badge bg-success">Published</span>
    <% else %>
      <span class="badge bg-secondary">Draft</span>
    <% end %>
  </p>

  <p class="text-muted">
    Posted by <strong><%= @post.user.name %></strong><br>
    Created: <%= @post.created_at.strftime("%Y-%m-%d %H:%M") %><br>
    Updated: <%= @post.updated_at.strftime("%Y-%m-%d %H:%M") %>
  </p>

  <div class="mt-4 mb-4 p-3 border rounded">
    <%= simple_format @post.content %>
  </div>

  <% if current_user&.admin? || @post.user == current_user %>
    <%= link_to "Edit", edit_post_path(@post), class: "btn btn-warning" %>

    <%= link_to "Delete Post", post_path(@post),
                data: { turbo_method: :delete, turbo_confirm: "Are you sure?" },
                class: "btn btn-danger" %>

  <% end %>


  <hr>

  <div class="mt-5">
    <h3><%= pluralize(@post.comments.count, "Comment") %></h3>

    <div class="mt-3" id="comments">
      <%= render @post.comments %>
    </div>

    <% if user_signed_in? %>
      <div class="card mt-4 shadow-sm">
        <div class="card-body">
          <h4>Add a Comment</h4>
          <%= render "comments/form", commentable: @post, comment: Comment.new %>
        </div>
      </div>
    <% else %>
      <div class="mt-3">
        <%= link_to "Sign in to comment", new_user_session_path, class: "btn btn-outline-primary" %>
      </div>
    <% end %>
  </div>
</div>

